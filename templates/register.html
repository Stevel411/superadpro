<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Register ‚Äî SuperAdPro</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=Rethink+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>

* { margin:0; padding:0; box-sizing:border-box; }
body { background:#050d1a; color:#e8f0fe; font-family:'DM Sans','Rethink Sans',sans-serif; min-height:100vh; }
a { color:#0284c7; }
input, select, textarea { font-family:'DM Sans','Rethink Sans',sans-serif; }

.form-group { margin-bottom:22px; }
label { display:block; font-size:19px; font-weight:600; letter-spacing:1.5px; text-transform:uppercase; color:rgba(200,220,255,0.7); margin-bottom:6px; }
input[type=text], input[type=email], input[type=password], input[type=tel], select, textarea {
  width:100%; background:rgba(5,13,26,0.8); border:1px solid rgba(0,180,216,0.15); border-radius:7px;
  padding:13px 16px; font-size:19px; color:#ffffff; transition:all 0.25s; outline:none;
}
input::placeholder, textarea::placeholder { color:rgba(200,220,255,0.45); }
input:focus, select:focus, textarea:focus {
  border-color:#0ea5e9; background:rgba(10,18,40,0.9); box-shadow:0 0 0 3px rgba(0,180,216,0.1);
}
.submit-btn {
  width:100%; font-weight:700; font-size:19px; color:#fff;
  background:linear-gradient(135deg,#0ea5e9,#38bdf8);
  padding:15px; border-radius:7px; border:none; cursor:pointer;
  font-family:'DM Sans','Rethink Sans',sans-serif; transition:all 0.25s;
  box-shadow:0 4px 14px rgba(0,180,216,0.3);
}
.submit-btn:hover { box-shadow:0 6px 24px rgba(0,180,216,0.45); transform:translateY(-1px); }
.error-msg { background:#fee2e2; border:1px solid #fecaca; border-radius:7px; padding:10px 14px; font-size:19px; color:#dc2626; margin-bottom:16px; display:none; }
.success-msg { background:#dcfce7; border:1px solid #bbf7d0; border-radius:7px; padding:10px 14px; font-size:19px; color:#16a34a; margin-bottom:16px; display:none; }
.divider-or { display:flex; align-items:center; gap:12px; margin:20px 0; }
.or-line { flex:1; height:1px; background:rgba(0,180,216,0.12); }
.or-text { font-size:19px; color:rgba(200,220,255,0.45); letter-spacing:2px; }

body { display:flex; flex-direction:column; }
.wrap { flex:1; display:flex; align-items:flex-start; justify-content:center; padding:40px 20px; }
.box { display:grid; grid-template-columns:1fr 1.2fr; max-width:1200px; width:100%; border:1px solid rgba(0,180,216,0.15); border-radius:14px; overflow:hidden; box-shadow:0 8px 40px rgba(0,0,0,0.09); }
.left { background:#0f172a; padding:52px 48px; display:flex; flex-direction:column; justify-content:flex-start; }
.right { background:rgba(10,18,40,0.9); padding:52px 56px; }
.l-eyebrow { font-size:19px; font-weight:700; letter-spacing:3px; text-transform:uppercase; color:rgba(0,240,255,0.5); margin-bottom:16px; }
.l-title { font-weight:800; font-size:30px; color:#fff; line-height:1.2; margin-bottom:12px; }
.l-sub { font-size:19px; color:rgba(255,255,255,0.6); line-height:1.65; margin-bottom:28px; }
.perk { display:flex; align-items:flex-start; gap:11px; font-size:19px; color:rgba(255,255,255,0.75); margin-bottom:12px; line-height:1.5; }
.perk-icon { width:26px; height:26px; border-radius:50%; background:rgba(0,180,216,0.12); border:1px solid rgba(0,180,216,0.25); display:flex; align-items:center; justify-content:center; font-size:19px; flex-shrink:0; margin-top:1px; }
.pkgs-mini { display:grid; grid-template-columns:repeat(4,1fr); gap:5px; margin-top:24px; }
.pkg-m { background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); border-radius:5px; padding:10px 6px; text-align:center; }
.pkg-m-price { font-size:19px; color:#16a34a; font-weight:800; }
.pkg-m-label { font-size:19px; color:rgba(255,255,255,0.4); text-transform:uppercase; letter-spacing:1px; margin-top:2px; }
.form-title { font-weight:800; font-size:32px; color:#ffffff; margin-bottom:4px; }
.form-sub { font-size:19px; color:rgba(200,220,255,0.7); margin-bottom:28px; }
.form-row { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
.beta-field { position:relative; }
.beta-badge { position:absolute; right:12px; top:50%; transform:translateY(-50%); font-size:19px; font-weight:700; letter-spacing:1px; color:#0284c7; background:rgba(0,180,216,0.08); border:1px solid rgba(0,180,216,0.2); padding:2px 7px; border-radius:3px; }
.wallet-hint { font-size:19px; color:#0284c7; margin-top:5px; }
.terms { display:flex; align-items:flex-start; gap:10px; margin-bottom:20px; }
.terms input[type=checkbox] { width:16px; height:16px; flex-shrink:0; margin-top:2px; accent-color:#0ea5e9; }
.terms-text { font-size:19px; color:rgba(200,220,255,0.7); line-height:1.5; }
.terms-text a { color:#0284c7; text-decoration:none; }
.login-link { text-align:center; margin-top:18px; font-size:19px; color:rgba(200,220,255,0.7); }
.login-link a { color:#0284c7; font-weight:700; text-decoration:none; }
@media(max-width:800px){ .box{grid-template-columns:1fr} .left{display:none} .form-row{grid-template-columns:1fr} }

/* ‚îÄ‚îÄ Login Modal ‚îÄ‚îÄ */
.login-overlay{position:fixed;inset:0;background:rgba(1,8,20,0.85);backdrop-filter:blur(6px);z-index:1001;display:flex;align-items:center;justify-content:center;padding:16px;opacity:0;pointer-events:none;transition:opacity 0.25s}
.login-overlay.open{opacity:1;pointer-events:all}
.login-modal{background:#0d1117;border:1px solid rgba(56,189,248,0.15);border-radius:18px;padding:36px 38px;width:100%;max-width:400px;position:relative;box-shadow:0 24px 80px rgba(0,0,0,0.6);transform:translateY(20px);transition:transform 0.25s}
.login-overlay.open .login-modal{transform:translateY(0)}
/* ‚îÄ‚îÄ Registration Modal ‚îÄ‚îÄ */
.reg-overlay{position:fixed;inset:0;background:rgba(1,8,20,0.85);backdrop-filter:blur(6px);z-index:1000;display:flex;align-items:center;justify-content:center;padding:16px;opacity:0;pointer-events:none;transition:opacity 0.25s}
.reg-overlay.open{opacity:1;pointer-events:all}
.reg-modal{background:#0d1117;border:1px solid rgba(56,189,248,0.15);border-radius:18px;padding:36px 38px;width:100%;max-width:460px;position:relative;box-shadow:0 24px 80px rgba(0,0,0,0.6);transform:translateY(20px);transition:transform 0.25s}
.reg-overlay.open .reg-modal{transform:translateY(0)}
.reg-close{position:absolute;top:14px;right:18px;background:none;border:none;color:rgba(200,220,255,0.4);font-size:22px;cursor:pointer;line-height:1;padding:4px 8px;border-radius:6px;transition:color 0.2s}
.reg-close:hover{color:rgba(200,220,255,0.9)}
.reg-title{font-size:22px;font-weight:800;color:#fff;margin-bottom:4px}
.reg-sub{font-size:16px;color:rgba(200,220,255,0.5);margin-bottom:24px}
.reg-field{margin-bottom:16px}
.reg-label{display:block;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(200,220,255,0.5);margin-bottom:6px}
.reg-input{width:100%;padding:11px 14px;border:1.5px solid rgba(0,212,255,0.12);border-radius:9px;background:rgba(0,212,255,0.04);color:#fff;font-size:16px;font-family:inherit;box-sizing:border-box;transition:border-color 0.2s}
.reg-input:focus{outline:none;border-color:#38bdf8;background:rgba(56,189,248,0.07)}
.reg-input::placeholder{color:rgba(200,220,255,0.25)}
.reg-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.reg-terms{display:flex;align-items:flex-start;gap:10px;margin-bottom:20px;font-size:16px;color:rgba(200,220,255,0.45);line-height:1.5}
.reg-terms input{width:15px;height:15px;flex-shrink:0;margin-top:1px;accent-color:#38bdf8}
.reg-terms a{color:rgba(0,212,255,0.7);text-decoration:none}
.reg-submit{width:100%;padding:13px;background:linear-gradient(135deg,#0ea5e9,#38bdf8);border:none;border-radius:10px;color:#fff;font-size:16px;font-weight:800;font-family:inherit;cursor:pointer;transition:opacity 0.2s}
.reg-submit:hover{opacity:0.9}
.reg-submit:disabled{opacity:0.5;cursor:not-allowed}
.reg-err{display:none;margin-bottom:14px;padding:10px 14px;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;font-size:16px;color:#dc2626;font-weight:600}
.reg-login{text-align:center;margin-top:16px;font-size:16px;color:rgba(200,220,255,0.4)}
.reg-login a{color:rgba(0,212,255,0.7);text-decoration:none;font-weight:600}
@media(max-width:500px){.reg-modal,.login-modal{padding:28px 22px}.reg-row{grid-template-columns:1fr}}
</style>
  <link rel="manifest" href="/static/manifest.json">
  <meta name="theme-color" content="#0a0a1a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SuperAdPro">
  <link rel="apple-touch-icon" href="/static/icons/icon-192.png">
</head>
<body>

<svg width="0" height="0" style="position:absolute">
  <defs>
    <linearGradient id="ob" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#0ea5e9"/><stop offset="30%" stop-color="#0284c7"/><stop offset="70%" stop-color="#38bdf8"/><stop offset="100%" stop-color="#0284c7"/></linearGradient>
    <linearGradient id="sf" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#0a0a2e"/><stop offset="40%" stop-color="#06061a"/><stop offset="100%" stop-color="#03031a"/></linearGradient>
    <linearGradient id="lg2" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#38bdf8"/><stop offset="25%" stop-color="#0ea5e9"/><stop offset="50%" stop-color="#0284c7"/><stop offset="75%" stop-color="#0ea5e9"/><stop offset="100%" stop-color="#38bdf8"/></linearGradient>
    <linearGradient id="hl" x1="0%" y1="0%" x2="60%" y2="100%"><stop offset="0%" stop-color="#ffffff" stop-opacity="0.12"/><stop offset="100%" stop-color="#000000" stop-opacity="0.15"/></linearGradient>
    <filter id="sg"><feGaussianBlur stdDeviation="2.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <linearGradient id="logo-grad-pg" x1="0" y1="0" x2="44" y2="44" gradientUnits="userSpaceOnUse">
      <stop stop-color="#0ea5e9"/>
      <stop offset="1" stop-color="#38bdf8"/>
    </linearGradient>
    <symbol id="shield" viewBox="0 0 44 44">
      <circle cx="22" cy="22" r="20" fill="url(#logo-grad-pg)"/>
      <path d="M18 13l14 9-14 9V13z" fill="#fff"/>
    </symbol>
  </defs>
</svg>

<nav style="position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:0 36px;height:62px;background:rgba(10,18,40,0.9);border-bottom:1px solid rgba(0,180,216,0.12);box-shadow:0 1px 8px rgba(0,0,0,0.06)">
  <a href="/" style="display:flex;align-items:center;gap:9px;text-decoration:none">
    <svg style="width:28px;height:28px" viewBox="0 0 32 32" fill="none"><circle cx="16" cy="16" r="16" fill="#0ea5e9"/><path d="M13 10.5L22 16L13 21.5V10.5Z" fill="white"/></svg>
    <span style="font-family:Sora,sans-serif;font-weight:800;font-size:19px;color:#fff">Super<span style="color:#38bdf8">Ad</span>Pro</span>
  </a>
  <ul style="display:flex;align-items:center;gap:4px;list-style:none"><li><a href="/how-it-works" style="font-size:19px;font-weight:500;color:rgba(200,220,255,0.7);text-decoration:none;padding:4px 10px;transition:color 0.2s" onmouseover="this.style.color='#0f172a'" onmouseout="this.style.color='#4a5a6e'">How It Works</a></li><li><a href="/packages" style="font-size:19px;font-weight:500;color:rgba(200,220,255,0.7);text-decoration:none;padding:4px 10px;transition:color 0.2s" onmouseover="this.style.color='#0f172a'" onmouseout="this.style.color='#4a5a6e'">Campaign Tiers</a></li><li><a href="/compensation-plan" style="font-size:19px;font-weight:500;color:rgba(200,220,255,0.7);text-decoration:none;padding:4px 10px;transition:color 0.2s" onmouseover="this.style.color='#0f172a'" onmouseout="this.style.color='#4a5a6e'">Compensation</a></li><li><a href="/how-it-works" style="font-size:19px;font-weight:500;color:rgba(200,220,255,0.7);text-decoration:none;padding:4px 10px;transition:color 0.2s" onmouseover="this.style.color='#0f172a'" onmouseout="this.style.color='#4a5a6e'">For Advertisers</a></li><li><a href="/faq" style="font-size:19px;font-weight:500;color:rgba(200,220,255,0.7);text-decoration:none;padding:4px 10px;transition:color 0.2s" onmouseover="this.style.color='#0f172a'" onmouseout="this.style.color='#4a5a6e'">FAQ</a></li></ul>
  <div style="display:flex;align-items:center;gap:10px">
    <a href="/login" style="font-size:19px;font-weight:600;color:rgba(200,220,255,0.7);text-decoration:none;padding:8px 16px">Sign In</a>
    <a href="/login" style="font-size:19px;font-weight:700;color:#fff;background:linear-gradient(135deg,#0ea5e9,#38bdf8);padding:9px 22px;border-radius:7px;text-decoration:none;transition:all 0.2s;box-shadow:0 2px 10px rgba(0,180,216,0.25)">Sign In ‚Üí</a>
  </div>
</nav>
<!-- ‚îÄ‚îÄ Login Modal ‚îÄ‚îÄ -->
<div class="login-overlay" id="loginOverlay" onclick="if(event.target===this)closeLoginModal()">
  <div class="login-modal">
    <button class="reg-close" onclick="closeLoginModal()" aria-label="Close">‚úï</button>
    <div class="reg-title">Log In</div>
    <div class="reg-sub">Welcome back ¬∑ Enter your details below</div>
    <div id="loginErr" class="reg-err"></div>
    <form id="loginModalForm">
      <div class="reg-field">
        <label class="reg-label">Username or Email</label>
        <input class="reg-input" type="text" id="loginUser" placeholder="username or email" required autocomplete="username">
      </div>
      <div class="reg-field" style="margin-bottom:8px">
        <label class="reg-label">Password</label>
        <input class="reg-input" type="password" id="loginPw" placeholder="Your password" required autocomplete="current-password">
      </div>
      <div style="text-align:right;margin-bottom:20px">
        <a href="/forgot-password" style="font-size:16px;color:rgba(0,212,255,0.6);text-decoration:none">Forgot password?</a>
      </div>
      <button type="submit" class="reg-submit" id="loginBtn">Log In ‚Üí</button>
    </form>
    <div class="reg-login">Don‚Äôt have an account? <a href="#" onclick="closeLoginModal();openRegModal();return false;">Register here ‚Üí</a></div>
  </div>
</div>
<!-- ‚îÄ‚îÄ Registration Modal ‚îÄ‚îÄ -->
<div class="reg-overlay" id="regOverlay" onclick="if(event.target===this)closeRegModal()">
  <div class="reg-modal">
    <button class="reg-close" onclick="closeRegModal()" aria-label="Close">‚úï</button>
    <div class="reg-title">Create Your Free Account</div>
    <div class="reg-sub">Takes 60 seconds ¬∑ No credit card required</div>
    <div id="regErr" class="reg-err"></div>
    <form id="regModalForm">
      <input type="hidden" id="regRef" name="ref" value="">
      <div class="reg-field">
        <label class="reg-label">First Name</label>
        <input class="reg-input" type="text" id="regFirstName" placeholder="John" required autocomplete="given-name">
      </div>
      <div class="reg-field">
        <label class="reg-label">Email Address</label>
        <input class="reg-input" type="email" id="regEmail" placeholder="john@example.com" required autocomplete="email">
      </div>
      <div class="reg-field">
        <label class="reg-label">Username <span style="font-weight:400;letter-spacing:0;text-transform:none;color:rgba(200,220,255,0.3)">‚Äî becomes your referral ID</span></label>
        <input class="reg-input" type="text" id="regUsername" placeholder="johnsmith99" required autocomplete="off" pattern="[a-zA-Z0-9_]{3,30}">
      </div>
      <div class="reg-row">
        <div class="reg-field">
          <label class="reg-label">Password</label>
          <input class="reg-input" type="password" id="regPw" placeholder="Min. 8 chars" required minlength="8" autocomplete="new-password">
        </div>
        <div class="reg-field">
          <label class="reg-label">Confirm</label>
          <input class="reg-input" type="password" id="regPwC" placeholder="Repeat" required autocomplete="new-password">
        </div>
      </div>
      <div class="reg-field" id="regSponsorField" style="display:none">
        <label class="reg-label">Referred by</label>
        <input class="reg-input" type="text" id="regSponsor" placeholder="Sponsor username" autocomplete="off" readonly style="opacity:0.6">
      </div>
      <div class="reg-terms">
        <input type="checkbox" id="regTerms" required>
        <div>I agree to the <a href="/legal" target="_blank">Terms of Service</a> and <a href="/legal" target="_blank">Privacy Policy</a>.</div>
      </div>
      <button type="submit" class="reg-submit" id="regBtn">Register Here ‚Üí</button>
    </form>
    <div class="reg-login">Already have an account? <a href="#" onclick="closeRegModal();openLoginModal();return false;">Log in here ‚Üí</a></div>
  </div>
</div>
<div class="wrap">
  <div class="box">
    <div class="left">
      <div class="l-eyebrow">‚¨° Join SuperAdPro</div>
      <div class="l-title">Start Advertising.<br><span style="background:linear-gradient(135deg,#0ea5e9,#38bdf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text">Start Earning.</span></div>
      <div class="l-sub">Join the platform built for advertisers, marketers and affiliates. Get engaged video views, earn commissions and grow your income grid.</div>
      <div class="perk"><div class="perk-icon">üé¨</div>Get engaged video views from active members for your content</div>
      <div class="perk"><div class="perk-icon">ü§ù</div>Earn 28% affiliate commission on every referral</div>
      <div class="perk"><div class="perk-icon">üîó</div>Instant USDT payments on Base Chain</div>
      <div class="perk"><div class="perk-icon">‚óà</div>Income Grid with 10-level earning structure</div>
      <div class="perk"><div class="perk-icon">üìä</div>Full dashboard with earnings tracking</div>
      <div style="margin-top:24px;font-size:19px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.35);margin-bottom:8px">Campaign Tiers</div>
      <div class="pkgs-mini">
        <div class="pkg-m"><div class="pkg-m-price">$20</div><div class="pkg-m-label">Starter</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$50</div><div class="pkg-m-label">Builder</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$100</div><div class="pkg-m-label">Pro</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$200</div><div class="pkg-m-label">Advanced</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$400</div><div class="pkg-m-label">Elite</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$600</div><div class="pkg-m-label">Premium</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$800</div><div class="pkg-m-label">Executive</div></div>
        <div class="pkg-m"><div class="pkg-m-price">$1,000</div><div class="pkg-m-label">Ultimate</div></div>
      </div>
    </div>
    <div class="right">
      <div class="form-title">Create Your Account</div>
      <div class="form-sub">Free to join ¬∑ Takes 60 seconds</div>
      <div class="error-msg" id="errorMsg"></div>
      <div class="success-msg" id="successMsg"></div>
      <form id="registerForm" action="/register" method="POST">
        <div class="form-group">
          <label>First Name</label>
          <input type="text" name="first_name" placeholder="John" value="{{ prefill.first_name if prefill else '' }}" required autocomplete="given-name">
        </div>
        <div class="form-group">
          <label>Email Address</label>
          <input type="email" name="email" placeholder="john@example.com" value="{{ prefill.email if prefill else '' }}" required autocomplete="email">
        </div>
        <div class="form-group">
          <label>Username</label>
          <input type="text" name="username" placeholder="johnsmith99" value="{{ prefill.username if prefill else '' }}" required autocomplete="off" pattern="[a-zA-Z0-9_]{3,30}" title="3‚Äì30 characters, letters, numbers and underscores only">
          <div style="font-size:16px;color:rgba(200,220,255,0.35);margin-top:4px">Letters, numbers and underscores only. This is your referral ID.</div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Password</label>
            <input type="password" name="password" placeholder="Min. 8 characters" required minlength="8" autocomplete="new-password">
          </div>
          <div class="form-group">
            <label>Confirm Password</label>
            <input type="password" name="confirm_password" placeholder="Repeat password" required autocomplete="new-password">
          </div>
        </div>
        <div class="form-group">
          <label>Referred by <span style="color:rgba(200,220,255,0.35);font-size:16px;font-weight:400;text-transform:none;letter-spacing:0">(optional)</span></label>
          <input type="text" name="ref" placeholder="Sponsor username" value="{{ sponsor or (prefill.ref if prefill else '') }}" autocomplete="off">
        </div>
        {% if beta_required %}
        <div class="form-group">
          <label>Beta Access Code</label>
          <div class="beta-field">
            <input type="text" name="beta_code" placeholder="Enter your beta code" required>
            <span class="beta-badge">BETA</span>
          </div>
        </div>
        {% endif %}
        <div style="background:rgba(0,180,216,0.04);border:1px solid rgba(0,180,216,0.12);border-radius:8px;padding:12px 14px;margin-bottom:18px">
          <div style="font-size:16px;color:rgba(200,220,255,0.5);line-height:1.6">
            üí° <strong style="color:rgba(200,220,255,0.8)">You can complete your profile later</strong> ‚Äî wallet address, country and other details can be added in your Account page after registration.
          </div>
        </div>
        <div class="terms">
          <input type="checkbox" id="terms" name="terms" required>
          <div class="terms-text">I agree to the <a href="/legal">Terms of Service</a> and <a href="/legal">Privacy Policy</a>. I understand this is a video advertising platform and membership grants access to campaign tiers.</div>
        </div>
        <button type="submit" class="submit-btn">Create My Free Account ‚Üí</button>
      </form>
      <div class="login-link">Already have an account? <a href="/login">Sign in here ‚Üí</a></div>
    </div>
  </div>
</div>
<script>
document.getElementById('registerForm').addEventListener('submit', function(e) {
  const pw = this.password.value, cpw = this.confirm_password.value;
  if (pw !== cpw) {
    e.preventDefault();
    const err = document.getElementById('errorMsg');
    err.textContent = 'Passwords do not match. Please try again.';
    err.style.display = 'block';
    setTimeout(() => err.style.display = 'none', 4000);
  }
});
</script>

<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/static/sw.js').catch(() => {});
  });
}
</script>
<script>
/* ‚îÄ‚îÄ Modal JS ‚îÄ‚îÄ */
function openRegModal(sponsor) {
  var o=document.getElementById('regOverlay'); if(!o)return;
  if(sponsor){document.getElementById('regRef').value=sponsor;document.getElementById('regSponsor').value=sponsor;document.getElementById('regSponsorField').style.display='block';}
  o.classList.add('open'); document.body.style.overflow='hidden';
  setTimeout(function(){var f=document.getElementById('regFirstName');if(f)f.focus();},300);
}
function closeRegModal(){var o=document.getElementById('regOverlay');if(o)o.classList.remove('open');document.body.style.overflow='';}
function openLoginModal(){
  var o=document.getElementById('loginOverlay'); if(!o)return;
  o.classList.add('open'); document.body.style.overflow='hidden';
  setTimeout(function(){var f=document.getElementById('loginUser');if(f)f.focus();},300);
}
function closeLoginModal(){var o=document.getElementById('loginOverlay');if(o)o.classList.remove('open');document.body.style.overflow='';}
document.addEventListener('keydown',function(e){if(e.key==='Escape'){closeLoginModal();closeRegModal();}});

document.addEventListener('DOMContentLoaded',function(){
  /* Register form */
  var rf=document.getElementById('regModalForm');
  if(rf) rf.addEventListener('submit',async function(e){
    e.preventDefault();
    var err=document.getElementById('regErr'),btn=document.getElementById('regBtn');
    err.style.display='none';
    if(document.getElementById('regPw').value!==document.getElementById('regPwC').value){err.textContent='Passwords do not match.';err.style.display='block';return;}
    if(!document.getElementById('regTerms').checked){err.textContent='Please agree to the Terms of Service.';err.style.display='block';return;}
    btn.disabled=true; btn.textContent='Creating account‚Ä¶';
    try{
      var res=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
        first_name:document.getElementById('regFirstName').value,
        email:document.getElementById('regEmail').value,
        username:document.getElementById('regUsername').value,
        password:document.getElementById('regPw').value,
        confirm_password:document.getElementById('regPwC').value,
        ref:document.getElementById('regRef').value,
        beta_code:''
      })});
      var d=await res.json();
      if(d.success){window.location.href=d.redirect||'/dashboard?new=1';return;}
      err.textContent=d.error||'Something went wrong.';err.style.display='block';
      btn.disabled=false;btn.textContent='Register Here ‚Üí';
    }catch(ex){err.textContent='Network error. Please try again.';err.style.display='block';btn.disabled=false;btn.textContent='Register Here ‚Üí';}
  });

  /* Login form */
  var lf=document.getElementById('loginModalForm');
  if(lf) lf.addEventListener('submit',async function(e){
    e.preventDefault();
    var err=document.getElementById('loginErr'),btn=document.getElementById('loginBtn');
    err.style.display='none'; btn.disabled=true; btn.textContent='Logging in‚Ä¶';
    try{
      var res=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
        username:document.getElementById('loginUser').value,
        password:document.getElementById('loginPw').value
      })});
      var d=await res.json();
      if(d.success){window.location.href=d.redirect||'/dashboard';return;}
      err.textContent=d.error||'Login failed.';err.style.display='block';
      btn.disabled=false;btn.textContent='Log In ‚Üí';
    }catch(ex){err.textContent='Network error. Please try again.';err.style.display='block';btn.disabled=false;btn.textContent='Log In ‚Üí';}
  });

  /* Auto-open from URL params */
  var p=new URLSearchParams(window.location.search);
  var sponsor=p.get('join')||p.get('ref')||'';
  if(p.get('login')==='1'){openLoginModal();}
  else if(sponsor||p.get('register')==='1'){openRegModal(sponsor);}
});
</script>
</body>
</html>