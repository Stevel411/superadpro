<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>My Campaigns — SuperAdPro</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=Sora:wght@700;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:#f0f2f8;color:#0f172a;min-height:100vh;display:flex}

/* ── Layout ── */
.sidebar{width:224px;height:100vh;background:#0a0a1a;border-right:1px solid rgba(0,212,255,0.08);position:fixed;top:0;left:0;z-index:100;display:flex;flex-direction:column;overflow-y:auto}
.sidebar::-webkit-scrollbar{width:4px}.sidebar::-webkit-scrollbar-thumb{background:rgba(56,189,248,0.2);border-radius:4px}
.sidebar-logo{display:flex;align-items:center;gap:10px;padding:20px 18px;border-bottom:1px solid rgba(255,255,255,0.06);text-decoration:none}
.nav-item{display:flex;align-items:center;gap:11px;padding:12px 18px;font-size:14px;font-weight:500;color:rgba(200,220,255,0.75);text-decoration:none;border-left:2px solid transparent;transition:all 0.2s}
.nav-item:hover{color:#38bdf8;background:rgba(56,189,248,0.06);border-left-color:rgba(56,189,248,0.3)}
.nav-item.active{color:#38bdf8;background:rgba(56,189,248,0.07);border-left-color:#38bdf8}
.nav-icon{font-size:16px;width:18px;text-align:center;flex-shrink:0}
.sidebar-footer{margin-top:auto;padding:14px 12px;border-top:1px solid rgba(255,255,255,0.06)}
.user-mini{display:flex;align-items:center;gap:10px;padding:10px 12px;background:rgba(56,189,248,0.05);border:1px solid rgba(0,212,255,0.1);border-radius:8px}
.user-avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#0ea5e9,#38bdf8);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:#fff;flex-shrink:0}
.main{margin-left:224px;flex:1;display:flex;flex-direction:column;min-height:100vh}

/* ── Topbar ── */
.topbar{display:flex;align-items:center;justify-content:space-between;padding:0 28px;height:70px;background:#0a0a1a;border-bottom:1px solid rgba(14,165,233,0.12);position:sticky;top:0;z-index:50}
.topbar-title{font-family:'Sora',sans-serif;font-size:18px;font-weight:800;color:#fff}
.topbar-sub{font-size:12px;color:rgba(0,212,255,0.5);margin-top:2px}

/* ── Content ── */
.content{padding:24px 28px;flex:1}

/* ── Stats row ── */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px}
.stat-card{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:18px 20px;position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.stat-card.c1::before{background:linear-gradient(90deg,#0ea5e9,#38bdf8)}
.stat-card.c2::before{background:linear-gradient(90deg,#22c55e,#4ade80)}
.stat-card.c3::before{background:linear-gradient(90deg,#f59e0b,#fbbf24)}
.stat-card.c4::before{background:linear-gradient(90deg,#8b5cf6,#a78bfa)}
.stat-label{font-size:11px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:#94a3b8;margin-bottom:6px}
.stat-value{font-family:'Sora',sans-serif;font-size:28px;font-weight:800;color:#0f172a}
.stat-detail{font-size:12px;color:#94a3b8;margin-top:4px}

/* ── Toolbar (filter + add) ── */
.toolbar{display:flex;align-items:center;justify-content:space-between;gap:14px;margin-bottom:20px;flex-wrap:wrap}
.filter-tabs{display:flex;gap:6px;flex-wrap:wrap}
.filter-tab{font-size:13px;font-weight:600;color:#64748b;background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:7px 16px;cursor:pointer;transition:all 0.2s;white-space:nowrap}
.filter-tab:hover{border-color:#0ea5e9;color:#0ea5e9}
.filter-tab.active{background:#0ea5e9;color:#fff;border-color:#0ea5e9}
.btn-add{font-size:13px;font-weight:700;color:#fff;background:linear-gradient(135deg,#0ea5e9,#38bdf8);padding:9px 20px;border-radius:8px;text-decoration:none;white-space:nowrap;transition:all 0.3s;display:inline-flex;align-items:center;gap:6px}
.btn-add:hover{box-shadow:0 4px 20px rgba(0,180,216,0.35);transform:translateY(-1px)}

/* ── Success banner ── */
.success-banner{background:rgba(22,163,74,0.08);border:1px solid rgba(22,163,74,0.2);border-radius:10px;padding:12px 18px;margin-bottom:20px;font-size:14px;color:#16a34a;display:flex;align-items:center;gap:8px;font-weight:600}

/* ── Campaign grid ── */
.campaigns-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:18px}
.campaign-card{background:#fff;border:1px solid #e2e8f0;border-radius:14px;overflow:hidden;transition:all 0.25s}
.campaign-card:hover{border-color:#cbd5e1;transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.06)}
.campaign-card.status-paused{opacity:0.7}
.video-wrap{position:relative;aspect-ratio:16/9;background:#0a0a1a}
.video-wrap iframe{width:100%;height:100%;border:none;display:block}
.video-overlay{position:absolute;top:10px;right:10px;display:flex;gap:6px}
.campaign-body{padding:16px 18px}
.campaign-meta{display:flex;align-items:center;gap:8px;margin-bottom:10px;flex-wrap:wrap}
.platform-badge{font-size:11px;font-weight:700;padding:3px 10px;border-radius:50px;letter-spacing:0.5px}
.status-dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:4px}
.status-dot.active{background:#22c55e;box-shadow:0 0 6px rgba(34,197,94,0.4)}
.status-dot.paused{background:#f59e0b}
.status-text{font-size:11px;font-weight:600;color:#64748b}
.campaign-title{font-size:16px;font-weight:700;color:#0f172a;margin-bottom:4px;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.campaign-cat{font-size:12px;color:#94a3b8;margin-bottom:10px;text-transform:capitalize}
.campaign-desc{font-size:13px;color:#64748b;line-height:1.5;margin-bottom:14px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.campaign-stats{display:flex;gap:16px;padding:12px 0;border-top:1px solid #f1f5f9;margin-bottom:10px}
.camp-stat{display:flex;flex-direction:column;gap:2px}
.camp-stat-val{font-size:14px;font-weight:700;color:#0f172a}
.camp-stat-lbl{font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:#94a3b8}
.campaign-footer{display:flex;align-items:center;justify-content:space-between}
.campaign-date{font-size:12px;color:#94a3b8}
.delete-btn{font-size:12px;font-weight:600;color:#dc2626;background:none;border:1px solid transparent;cursor:pointer;font-family:inherit;padding:4px 10px;border-radius:6px;transition:all 0.2s}
.delete-btn:hover{background:rgba(220,38,38,0.06);border-color:rgba(220,38,38,0.15)}

/* ── Empty state ── */
.empty-state{text-align:center;padding:80px 20px;background:#fff;border:2px dashed #e2e8f0;border-radius:16px}
.empty-icon{font-size:48px;margin-bottom:16px}
.empty-title{font-size:18px;font-weight:700;color:#0f172a;margin-bottom:8px}
.empty-sub{font-size:14px;color:#64748b;margin-bottom:24px;line-height:1.6;max-width:420px;margin-left:auto;margin-right:auto}

/* ── Delete modal ── */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:999;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
.modal-overlay.open{display:flex}
.modal{background:#fff;border-radius:16px;padding:36px;max-width:400px;width:90%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.15)}
.modal h3{font-size:18px;font-weight:800;color:#0f172a;margin-bottom:8px}
.modal p{font-size:14px;color:#64748b;margin-bottom:24px;line-height:1.5}
.modal-btns{display:flex;gap:12px;justify-content:center}
.modal-cancel{font-size:14px;font-weight:600;color:#64748b;background:#f1f5f9;border:none;border-radius:8px;padding:10px 24px;cursor:pointer;font-family:inherit;transition:background 0.2s}
.modal-cancel:hover{background:#e2e8f0}
.modal-confirm{font-size:14px;font-weight:700;color:#fff;background:#dc2626;border:none;border-radius:8px;padding:10px 24px;cursor:pointer;font-family:inherit;transition:background 0.2s}
.modal-confirm:hover{background:#b91c1c}

/* ── Responsive ── */
@media(max-width:768px){.sidebar{display:none}.main{margin-left:0}.stats-row{grid-template-columns:1fr 1fr}.campaigns-grid{grid-template-columns:1fr}.content{padding:16px}.topbar{padding:0 16px}}
@media(max-width:480px){.stats-row{grid-template-columns:1fr}.toolbar{flex-direction:column;align-items:stretch}}

/* ── Boost ── */
.boost-badge{position:absolute;top:10px;left:10px;display:inline-flex;align-items:center;gap:5px;font-size:10px;font-weight:800;letter-spacing:1px;text-transform:uppercase;color:#fff;background:linear-gradient(135deg,#f59e0b,#ef4444);padding:4px 10px;border-radius:50px;box-shadow:0 2px 8px rgba(245,158,11,0.4);z-index:2}
.boost-badge .pulse-dot{width:6px;height:6px;border-radius:50%;background:#fff;animation:bpulse 1.5s infinite}
@keyframes bpulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.7)}}
.boost-btn{font-size:12px;font-weight:700;color:#f59e0b;background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.2);padding:5px 12px;border-radius:6px;cursor:pointer;font-family:inherit;transition:all 0.2s;display:inline-flex;align-items:center;gap:4px}
.boost-btn:hover{background:rgba(245,158,11,0.15);color:#d97706;border-color:rgba(245,158,11,0.35)}
.boost-btn.active{color:#16a34a;border-color:rgba(22,163,74,0.25);background:rgba(22,163,74,0.06);cursor:default}

/* ── Boost modal ── */
.boost-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
.boost-overlay.open{display:flex}
.boost-modal{background:#fff;border-radius:16px;padding:32px;max-width:520px;width:92%;box-shadow:0 20px 60px rgba(0,0,0,0.15);position:relative}
.boost-modal-close{position:absolute;top:12px;right:14px;background:none;border:none;font-size:20px;color:#94a3b8;cursor:pointer}
.boost-modal h3{font-family:'Sora',sans-serif;font-size:20px;font-weight:800;color:#0f172a;margin-bottom:4px}
.boost-modal-sub{font-size:14px;color:#64748b;margin-bottom:20px}
.boost-tiers-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.boost-tier{border:2px solid #e2e8f0;border-radius:12px;padding:16px;cursor:pointer;transition:all 0.2s;position:relative}
.boost-tier:hover{border-color:#f59e0b}
.boost-tier.selected{border-color:#f59e0b;background:rgba(245,158,11,0.04);box-shadow:0 0 0 3px rgba(245,158,11,0.1)}
.boost-tier-name{font-size:15px;font-weight:800;color:#0f172a;margin-bottom:2px}
.boost-tier-price{font-size:22px;font-weight:800;color:#f59e0b;margin-bottom:4px}
.boost-tier-detail{font-size:11px;color:#94a3b8;line-height:1.4}
.boost-tier-multi{position:absolute;top:10px;right:12px;font-size:10px;font-weight:800;color:#fff;background:linear-gradient(135deg,#f59e0b,#ef4444);padding:2px 8px;border-radius:50px}
.boost-confirm-btn{width:100%;padding:13px;background:linear-gradient(135deg,#f59e0b,#ef4444);color:#fff;font-weight:700;font-size:15px;border:none;border-radius:10px;cursor:pointer;font-family:inherit;transition:all 0.2s}
.boost-confirm-btn:hover{box-shadow:0 4px 20px rgba(245,158,11,0.35);transform:translateY(-1px)}
.boost-confirm-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;box-shadow:none}
.boost-balance{font-size:13px;color:#64748b;text-align:center;margin-top:10px}
.boost-commission{font-size:12px;color:#16a34a;text-align:center;margin-top:6px;font-weight:600}
.boost-err{display:none;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);color:#dc2626;padding:10px 14px;border-radius:8px;font-size:13px;margin-bottom:14px}

</style>
<link rel="stylesheet" href="/static/mobile.css">
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#0a0a1a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="SuperAdPro">
<link rel="apple-touch-icon" href="/static/icons/icon-192.png">
</head>
<body>
<div class="layout">
  {% include "_sidebar.html" %}
  <div class="main">

<!-- Mobile Topbar -->
<div class="mobile-topbar">
  <a class="mobile-topbar-left" href="/dashboard">
    <svg width="26" height="26" viewBox="0 0 100 100">
      <defs><linearGradient id="mhg" x1="0" y1="0" x2="44" y2="44" gradientUnits="userSpaceOnUse"><stop stop-color="#0ea5e9"/><stop offset="1" stop-color="#38bdf8"/></linearGradient></defs>
      <circle cx="22" cy="22" r="20" fill="url(#mhg)"/><path d="M18 13l14 9-14 9V13z" fill="#fff"/>
    </svg>
    <div>
      <div class="mobile-topbar-name">SuperAdPro</div>
      <div class="mobile-topbar-page">My Campaigns</div>
    </div>
  </a>
  <div class="mobile-balance-chip">${{ '%.2f'|format(balance) }} USDT</div>
</div>

<!-- Topbar -->
<div class="topbar">
  <div>
    <div class="topbar-title">My Campaigns</div>
    <div class="topbar-sub">Manage your video ad library</div>
  </div>
  <a href="/upload" class="btn-add">+ Add Video</a>
</div>

<!-- Content -->
<div class="content">

  {% if added %}
  <div class="success-banner">&#x2705; Video added successfully — your campaign is now live.</div>
  {% endif %}

  <!-- Stats -->
  {% set active_count = campaigns|selectattr('status','equalto','active')|list|length %}
  {% set paused_count = campaigns|selectattr('status','equalto','paused')|list|length %}
  {% set total_views = campaigns|sum(attribute='views_delivered') %}
  {% set platforms = campaigns|map(attribute='platform')|unique|list %}

  <div class="stats-row">
    <div class="stat-card c1">
      <div class="stat-label">Total Campaigns</div>
      <div class="stat-value">{{ campaigns|length }}</div>
      <div class="stat-detail">{{ active_count }} active &middot; {{ paused_count }} paused</div>
    </div>
    <div class="stat-card c2">
      <div class="stat-label">Active</div>
      <div class="stat-value">{{ active_count }}</div>
      <div class="stat-detail">Delivering views now</div>
    </div>
    <div class="stat-card c3">
      <div class="stat-label">Total Views</div>
      <div class="stat-value">{{ '{:,}'.format(total_views) }}</div>
      <div class="stat-detail">Across all campaigns</div>
    </div>
    <div class="stat-card c4">
      <div class="stat-label">Active Boosts</div>
      <div class="stat-value">{{ active_boosts|length }}</div>
      <div class="stat-detail">{{ platforms|join(', ')|title if platforms else 'None yet' }}</div>
    </div>
  </div>

  <!-- Toolbar -->
  <div class="toolbar">
    <div class="filter-tabs">
      <button class="filter-tab active" onclick="filterCampaigns('all')">All ({{ campaigns|length }})</button>
      <button class="filter-tab" onclick="filterCampaigns('active')">Active ({{ active_count }})</button>
      {% if paused_count %}<button class="filter-tab" onclick="filterCampaigns('paused')">Paused ({{ paused_count }})</button>{% endif %}
      {% for p in platforms %}
      <button class="filter-tab" onclick="filterCampaigns('platform-{{ p }}')">{{ platform_label(p) }}</button>
      {% endfor %}
    </div>
    <a href="/upload" class="btn-add" style="display:none">+ Add Video</a>
  </div>

  <!-- Campaign Grid -->
  {% if campaigns %}
  <div class="campaigns-grid" id="campaignsGrid">
    {% for c in campaigns %}
    <div class="campaign-card {% if c.status == 'paused' %}status-paused{% endif %}" data-status="{{ c.status }}" data-platform="{{ c.platform }}">

      <div class="video-wrap">
        {% if c.id in active_boosts %}
        <div class="boost-badge"><span class="pulse-dot"></span> {{ active_boosts[c.id].tier|title }} Boost</div>
        {% endif %}
        <iframe src="{{ c.embed_url }}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe>
      </div>

      <div class="campaign-body">
        <div class="campaign-meta">
          <span class="platform-badge" style="color:{{ platform_colour(c.platform) }};border:1px solid {{ platform_colour(c.platform) }}33;background:{{ platform_colour(c.platform) }}0d">
            {{ platform_label(c.platform) }}
          </span>
          <span style="display:flex;align-items:center;gap:4px">
            <span class="status-dot {{ c.status }}"></span>
            <span class="status-text">{{ c.status|title }}</span>
          </span>
        </div>

        <div class="campaign-title">{{ c.title }}</div>
        {% if c.category %}
        <div class="campaign-cat">{{ c.category|replace('_',' ')|title }}</div>
        {% endif %}
        {% if c.description %}
        <div class="campaign-desc">{{ c.description }}</div>
        {% endif %}

        <div class="campaign-stats">
          <div class="camp-stat">
            <div class="camp-stat-val">{{ '{:,}'.format(c.views_delivered) }}</div>
            <div class="camp-stat-lbl">Views</div>
          </div>
          {% if c.views_target > 0 %}
          <div class="camp-stat">
            <div class="camp-stat-val">{{ '{:,}'.format(c.views_target) }}</div>
            <div class="camp-stat-lbl">Target</div>
          </div>
          <div class="camp-stat">
            <div class="camp-stat-val">{{ '%d'|format((c.views_delivered / c.views_target * 100) if c.views_target > 0 else 0) }}%</div>
            <div class="camp-stat-lbl">Complete</div>
          </div>
          {% endif %}
        </div>

        <div class="campaign-footer">
          <span class="campaign-date">Added {{ c.created_at.strftime('%d %b %Y') }}</span>
          <div style="display:flex;align-items:center;gap:8px">
            {% if c.id in active_boosts %}
            <button class="boost-btn active" disabled>&#x1F525; Boosted</button>
            {% else %}
            <button class="boost-btn" onclick="openBoostModal({{ c.id }}, '{{ c.title|replace("'","\\'")|truncate(30) }}', 'video')">&#x1F680; Boost</button>
            {% endif %}
            <button class="delete-btn" onclick="confirmDelete({{ c.id }}, '{{ c.title|replace("'","\\'")|truncate(30) }}')">
              Remove
            </button>
          </div>
        </div>
      </div>

    </div>
    {% endfor %}
  </div>

  {% else %}
  <div class="empty-state">
    <div class="empty-icon">&#x1F3AC;</div>
    <div class="empty-title">No campaigns yet</div>
    <div class="empty-sub">Add your first video from YouTube, Rumble or Vimeo. Paste the link and it appears here instantly — no file uploads needed.</div>
    <a href="/upload" class="btn-add">Add Your First Video &rarr;</a>
  </div>
  {% endif %}

<!-- Boost modal -->
<div class="boost-overlay" id="boostModal" onclick="if(event.target===this)closeBoostModal()">
  <div class="boost-modal">
    <button class="boost-modal-close" onclick="closeBoostModal()">&#x2715;</button>
    <h3>&#x1F680; Boost Campaign</h3>
    <div class="boost-modal-sub">Boosting "<span id="boostTargetName"></span>" — more views, faster delivery</div>
    <div class="boost-err" id="boostErr"></div>
    <div class="boost-tiers-grid" id="boostTiersGrid">
      {% for key, t in boost_tiers.items() %}
      <div class="boost-tier" data-tier="{{ key }}" data-price="{{ t.price }}" onclick="selectBoostTier(this, '{{ key }}')">
        <div class="boost-tier-multi">{{ t.multiplier }}&times;</div>
        <div class="boost-tier-name">{{ t.label }}</div>
        <div class="boost-tier-price">${{ t.price }}</div>
        <div class="boost-tier-detail">{{ t.hours // 24 }} day{{ 's' if t.hours > 24 else '' }} &middot; {{ t.multiplier }}&times; priority</div>
      </div>
      {% endfor %}
    </div>
    <button class="boost-confirm-btn" id="boostConfirmBtn" onclick="confirmBoost()" disabled>Select a tier above</button>
    <div class="boost-balance">Your balance: <strong>${{ '%.2f'|format(balance) }}</strong> USDT</div>
    <div class="boost-commission">&#x1F4B0; 75% of every boost purchase goes to your sponsor</div>
  </div>
</div>

</div><!-- /content -->

<!-- Delete confirm modal -->
<div class="modal-overlay" id="deleteModal">
  <div class="modal">
    <h3>Remove Campaign?</h3>
    <p id="deleteMsg">This will remove the video from your campaign library.</p>
    <form method="POST" action="/delete-campaign" id="deleteForm">
      <input type="hidden" name="campaign_id" id="deleteCampaignId">
      <div class="modal-btns">
        <button type="button" class="modal-cancel" onclick="closeModal()">Cancel</button>
        <button type="submit" class="modal-confirm">Remove</button>
      </div>
    </form>
  </div>
</div>

<script>
/* ── Delete modal ── */
function confirmDelete(id, title) {
  document.getElementById('deleteCampaignId').value = id;
  document.getElementById('deleteMsg').textContent = 'Remove "' + title + '" from your campaign library?';
  document.getElementById('deleteModal').classList.add('open');
}
function closeModal() {
  document.getElementById('deleteModal').classList.remove('open');
}
document.getElementById('deleteModal').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});

/* ── Campaign filter ── */
function filterCampaigns(filter) {
  var cards = document.querySelectorAll('.campaign-card');
  var tabs = document.querySelectorAll('.filter-tab');

  tabs.forEach(function(t) { t.classList.remove('active'); });
  event.target.classList.add('active');

  cards.forEach(function(card) {
    var show = false;
    if (filter === 'all') show = true;
    else if (filter === 'active' || filter === 'paused') show = card.dataset.status === filter;
    else if (filter.startsWith('platform-')) show = card.dataset.platform === filter.replace('platform-','');
    card.style.display = show ? '' : 'none';
  });
}

/* ── Boost modal ── */
var boostTargetId = 0;
var boostTargetType = '';
var boostSelectedTier = '';

function openBoostModal(targetId, title, type) {
  boostTargetId = targetId;
  boostTargetType = type;
  boostSelectedTier = '';
  document.getElementById('boostTargetName').textContent = title;
  document.getElementById('boostErr').style.display = 'none';
  document.getElementById('boostConfirmBtn').disabled = true;
  document.getElementById('boostConfirmBtn').textContent = 'Select a tier above';
  document.querySelectorAll('.boost-tier').forEach(function(t) { t.classList.remove('selected'); });
  document.getElementById('boostModal').classList.add('open');
}

function closeBoostModal() {
  document.getElementById('boostModal').classList.remove('open');
}

function selectBoostTier(el, tier) {
  document.querySelectorAll('.boost-tier').forEach(function(t) { t.classList.remove('selected'); });
  el.classList.add('selected');
  boostSelectedTier = tier;
  var price = el.dataset.price;
  var btn = document.getElementById('boostConfirmBtn');
  btn.disabled = false;
  btn.textContent = 'Boost for $' + price + ' USDT';
}

async function confirmBoost() {
  if (!boostSelectedTier) return;
  var btn = document.getElementById('boostConfirmBtn');
  var err = document.getElementById('boostErr');
  err.style.display = 'none';
  btn.disabled = true;
  btn.textContent = 'Processing...';

  try {
    var r = await fetch('/api/boost/purchase', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        boost_type: boostTargetType,
        target_id: boostTargetId,
        tier: boostSelectedTier
      })
    });
    var d = await r.json();
    if (d.success) {
      closeBoostModal();
      window.location.reload();
    } else {
      err.textContent = d.error || 'Boost failed';
      err.style.display = 'block';
      btn.disabled = false;
      btn.textContent = 'Try Again';
    }
  } catch(x) {
    err.textContent = 'Network error — please try again';
    err.style.display = 'block';
    btn.disabled = false;
    btn.textContent = 'Try Again';
  }
}
</script>

<!-- Mobile Bottom Nav -->
<div class="mobile-nav">
  <div class="mobile-nav-inner">
    <a href="/dashboard" class="mob-nav-item"><span class="mob-nav-icon">&#x229E;</span><span class="mob-nav-label">Home</span></a>
    <a href="/watch" class="mob-nav-item"><span class="mob-nav-icon">&#x25B6;</span><span class="mob-nav-label">Watch</span></a>
    <a href="/income-grid" class="mob-nav-item"><span class="mob-nav-icon">&#x26A1;</span><span class="mob-nav-label">Grid</span></a>
    <a href="/wallet" class="mob-nav-item"><span class="mob-nav-icon">&#x25CE;</span><span class="mob-nav-label">Wallet</span></a>
    <a href="/account" class="mob-nav-item"><span class="mob-nav-icon">&#x25C9;</span><span class="mob-nav-label">Account</span></a>
  </div>
</div>

<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/static/sw.js').catch(function(){});
  });
}
</script>

  </div><!-- /main -->
</div><!-- /layout -->
</body>
</html>
